{% extends 'base.html' %}
{% load leaflet_tags %}
{% block body %}
    <title>{{ activity.title }} - Workoutizer</title>
    <body>
    <div class="container">
        <h3 class="float-left">{{ activity.title }}&nbsp;&nbsp;<i class="fas fa-{{ activity.sport.icon }}"
                                                                  style="color: {{ activity.sport.color }};"></i></h3>
        <a class="float-right btn btn-warning" href="{{ activity.id }}/edit"><i class="fas fa-pen"></i>&nbsp;&nbsp;Edit</a>
        <div class="clearfix"></div>
        <p>{{ activity.date }}</p>
        <hr>
        <br>
        <div class="row">
            <div class="col-sm-3">
                <table class="table table-hover">
                    <tr>
                        <th scope="row">Sport</th>
                        <td><a href="/sport/{{ activity.sport.slug }}">{{ activity.sport }}</a>
                        </td>
                    <tr>
                    <tr>
                        <th scope="row">Duration</th>
                        <td>{{ activity.duration }} min</td>
                    <tr>
                    <tr>
                        <th scope="row">Distance</th>
                        <td>{{ activity.distance }} km</td>
                    <tr>
                    <tr>
                        <th scope="row">Description</th>
                        <td>{{ activity.description }}</td>
                    <tr>
                </table>
            </div>
            {% if activity.trace_file %}
                <div class="col-sm-9">
                    <div id="mapid"></div>
                    <script type="text/javascript">
                        var mymap = L.map('mapid').setView([{{ trace.center_lon }}, {{ trace.center_lat }}], 13);
                        L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
                        }).addTo(mymap);
                        var myLines = [{
                            {#"type": "LineString",#}
                            {#"coordinates": [[-100, 40], [-105, 45], [-110, 55]]}, {#}
                            "type": "LineString",
                            "coordinates": {{ trace.coordinates }}
                        }];
                        var myStyle = {
                            "color": "{{ trace.color }}",
                            "weight": {{ trace.weight }},
                            "opacity": {{ trace.opacity }}
                        };

                        numPts = {{ trace.coordinates }}.length;

                        var beg = {{ trace.coordinates }}[0];
                        var end = {{ trace.coordinates }}[numPts - 1];

                        L.marker([beg[1],beg[0]]).addTo(mymap);
                        L.marker([end[1],end[0]]).addTo(mymap);

                        L.geoJSON(myLines, {style: myStyle}).addTo(mymap);
                    </script>
                </div>
                <br>
            {% endif %}
        </div>
    </div>
    </body>
{% endblock %}